<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>EcoExtract: Complete Workflow Guide • ecoextract</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EcoExtract: Complete Workflow Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecoextract</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/ecoextract-workflow.html">Guide</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/configuration.html">Configuration</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/testing.html">Testing</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/n8layman/ecoextract/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>EcoExtract: Complete Workflow Guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/n8layman/ecoextract/blob/main/vignettes/ecoextract-workflow.Rmd" class="external-link"><code>vignettes/ecoextract-workflow.Rmd</code></a></small>
      <div class="d-none name"><code>ecoextract-workflow.Rmd</code></div>
    </div>

    
    
<p>This guide walks you through the complete EcoExtract workflow – from
installation to validated, exported data. By the end, you’ll know how to
process PDFs, review extraction results, and calculate accuracy
metrics.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level3">
<h3 id="the-three-package-ecosystem">The Three-Package Ecosystem<a class="anchor" aria-label="anchor" href="#the-three-package-ecosystem"></a>
</h3>
<p>EcoExtract works as part of three packages:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/n8layman/ohseer" class="external-link">ohseer</a></td>
<td>OCR processing – converts PDFs to markdown via Tensorlake</td>
</tr>
<tr class="even">
<td><a href="https://github.com/n8layman/ecoextract" class="external-link">ecoextract</a></td>
<td>Data extraction pipeline – metadata, records, refinement, SQLite
storage</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/n8layman/ecoreview" class="external-link">ecoreview</a></td>
<td>Human review – Shiny app for editing, adding, deleting records</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<ul>
<li>R version 4.1.0 or higher</li>
<li>RStudio (recommended)</li>
<li>API keys for Tensorlake (OCR) and Anthropic Claude (extraction)</li>
</ul>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Install all three packages from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using pak (recommended)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"n8layman/ohseer"</span><span class="op">)</span>      <span class="co"># OCR processing</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"n8layman/ecoextract"</span><span class="op">)</span>  <span class="co"># Data extraction</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"n8layman/ecoreview"</span><span class="op">)</span>   <span class="co"># Review app (optional)</span></span>
<span></span>
<span><span class="co"># Or using devtools</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"n8layman/ohseer"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"n8layman/ecoextract"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"n8layman/ecoreview"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/n8layman/ecoextract" class="external-link">ecoextract</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Optional dependencies:</strong></p>
<ul>
<li>
<code>crew</code> – for parallel processing
(<code>install.packages("crew")</code>)</li>
<li>
<code>ecoreview</code> – for human review of extracted records</li>
</ul>
</div>
<div class="section level3">
<h3 id="api-key-setup">API Key Setup<a class="anchor" aria-label="anchor" href="#api-key-setup"></a>
</h3>
<p>EcoExtract requires API keys for OCR (Tensorlake) and data extraction
(Anthropic Claude).</p>
<p><strong>Get API keys from:</strong></p>
<ul>
<li>Tensorlake (for OCR): <a href="https://www.tensorlake.ai/" class="external-link uri">https://www.tensorlake.ai/</a>
</li>
<li>Anthropic Claude (for extraction): <a href="https://console.anthropic.com/" class="external-link uri">https://console.anthropic.com/</a>
</li>
</ul>
<p><strong>Before creating your <code>.env</code> file, verify it’s in
<code>.gitignore</code>:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Check that .env is in .gitignore</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">grep</span> <span class="st">"^\.env$"</span> .gitignore</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># If not found, add it NOW before creating the file:</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="bu">echo</span> <span class="st">".env"</span> <span class="op">&gt;&gt;</span> .gitignore</span></code></pre></div>
<p><strong>Create a <code>.env</code> file in your project
root:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="va">ANTHROPIC_API_KEY</span><span class="op">=</span>sk-ant-api03-your-key-here</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="va">TENSORLAKE_API_KEY</span><span class="op">=</span>your-tensorlake-key-here</span></code></pre></div>
<p>The <code>.env</code> file is automatically loaded when R starts in
the project directory. You can also load it manually:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRenviron.html" class="external-link">readRenviron</a></span><span class="op">(</span><span class="st">".env"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or set keys directly in R</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>ANTHROPIC_API_KEY <span class="op">=</span> <span class="st">"your_key_here"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>TENSORLAKE_API_KEY <span class="op">=</span> <span class="st">"your_key_here"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify keys are loaded</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"ANTHROPIC_API_KEY"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"TENSORLAKE_API_KEY"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Verify before committing:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># This should show no output if .env is properly ignored:</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">git</span> status <span class="kw">|</span> <span class="fu">grep</span> <span class="st">".env"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="verify-installation">Verify Installation<a class="anchor" aria-label="anchor" href="#verify-installation"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/n8layman/ecoextract" class="external-link">ecoextract</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check that functions are available</span></span>
<span><span class="op">?</span><span class="va">process_documents</span></span>
<span><span class="op">?</span><span class="va">get_records</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="processing-documents">Processing Documents<a class="anchor" aria-label="anchor" href="#processing-documents"></a>
</h2>
<div class="section level3">
<h3 id="the-four-step-pipeline">The Four-Step Pipeline<a class="anchor" aria-label="anchor" href="#the-four-step-pipeline"></a>
</h3>
<p><code><a href="../reference/process_documents.html">process_documents()</a></code> orchestrates a four-step extraction
pipeline:</p>
<ol style="list-style-type: decimal">
<li>
<strong>OCR Processing</strong> (via ohseer) – Convert PDF to
markdown text with embedded images</li>
<li>
<strong>Metadata Extraction</strong> – Extract publication metadata
(title, authors, DOI, etc.)</li>
<li>
<strong>Data Extraction</strong> – Extract structured records using
Claude according to your schema</li>
<li>
<strong>Refinement</strong> (optional) – Enhance and verify
extracted data</li>
</ol>
</div>
<div class="section level3">
<h3 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Process a single PDF</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"my_paper.pdf"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"ecoextract_records.db"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Process all PDFs in a folder</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"pdfs/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"ecoextract_records.db"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Process with refinement enabled</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"pdfs/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"ecoextract_records.db"</span>,</span>
<span>  run_refinement <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This automatically handles OCR, metadata extraction, data extraction
with Claude, saving to SQLite, and smart skip logic (re-running skips
completed steps).</p>
</div>
<div class="section level3">
<h3 id="parallel-processing">Parallel Processing<a class="anchor" aria-label="anchor" href="#parallel-processing"></a>
</h3>
<p>For faster processing of multiple documents, use parallel processing
with the <code>crew</code> package:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"crew"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Process with 4 parallel workers</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"pdfs/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"ecoextract_records.db"</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Creates ecoextract_YYYYMMDD_HHMMSS.log</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Benefits:</p>
<ul>
<li>Each worker processes a complete document (all 4 steps)</li>
<li>Crash-resilient: completed documents saved immediately</li>
<li>Progress shown as documents complete:
<code>[1/10] paper.pdf completed</code>
</li>
<li>Re-run to resume: skip logic detects completed documents</li>
</ul>
</div>
<div class="section level3">
<h3 id="skip-logic">Skip Logic<a class="anchor" aria-label="anchor" href="#skip-logic"></a>
</h3>
<p>When you re-run <code><a href="../reference/process_documents.html">process_documents()</a></code>, it automatically
skips steps that have already completed. This allows you to resume
interrupted processing, add new PDFs, or re-run specific steps after
fixing issues.</p>
<div class="section level4">
<h4 id="skip-behavior">Skip Behavior<a class="anchor" aria-label="anchor" href="#skip-behavior"></a>
</h4>
<p>Each step checks its status in the database:</p>
<table class="table">
<thead><tr class="header">
<th>Step</th>
<th>Skips When</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>OCR</td>
<td>
<code>ocr_status = "completed"</code> AND markdown exists</td>
</tr>
<tr class="even">
<td>Metadata</td>
<td>
<code>metadata_status = "completed"</code> AND metadata exists</td>
</tr>
<tr class="odd">
<td>Extraction</td>
<td>
<code>extraction_status = "completed"</code> AND records exist</td>
</tr>
<tr class="even">
<td>Refinement</td>
<td>
<code>refinement_status = "completed"</code> (opt-in only)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="cascade-logic">Cascade Logic<a class="anchor" aria-label="anchor" href="#cascade-logic"></a>
</h4>
<p>When a step is forced to re-run, downstream steps are automatically
invalidated:</p>
<table class="table">
<thead><tr class="header">
<th>If This Re-runs</th>
<th>These Become Stale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>OCR</td>
<td>Metadata, Extraction</td>
</tr>
<tr class="even">
<td>Metadata</td>
<td>Extraction</td>
</tr>
<tr class="odd">
<td>Extraction</td>
<td>(nothing)</td>
</tr>
<tr class="even">
<td>Refinement</td>
<td>(nothing, opt-in only)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="force-reprocessing">Force Reprocessing<a class="anchor" aria-label="anchor" href="#force-reprocessing"></a>
</h4>
<p>Override skip logic to force reprocessing:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Force reprocess all documents from OCR onward</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"pdfs/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"ecoextract_records.db"</span>,</span>
<span>  force_reprocess_ocr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Force reprocess specific documents only (by document_id)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"pdfs/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"ecoextract_records.db"</span>,</span>
<span>  force_reprocess_extraction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">12L</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Each <code>force_reprocess_*</code> parameter accepts:</p>
<ul>
<li>
<code>NULL</code> (default) – use normal skip logic</li>
<li>
<code>TRUE</code> – force reprocess all documents</li>
<li>Integer vector (e.g., <code>c(5L, 12L)</code>) – force reprocess
specific document IDs</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="deduplication">Deduplication<a class="anchor" aria-label="anchor" href="#deduplication"></a>
</h3>
<p>During extraction, records are automatically deduplicated against
existing records in the database. Three similarity methods are
available:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default: LLM-based deduplication (most accurate)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span><span class="st">"pdfs/"</span>, db_conn <span class="op">=</span> <span class="st">"records.db"</span>,</span>
<span>                            similarity_method <span class="op">=</span> <span class="st">"llm"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Embedding-based with custom threshold</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span><span class="st">"pdfs/"</span>, db_conn <span class="op">=</span> <span class="st">"records.db"</span>,</span>
<span>                            similarity_method <span class="op">=</span> <span class="st">"embedding"</span>,</span>
<span>                            min_similarity <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fast local deduplication (no API calls)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span><span class="st">"pdfs/"</span>, db_conn <span class="op">=</span> <span class="st">"records.db"</span>,</span>
<span>                            similarity_method <span class="op">=</span> <span class="st">"jaccard"</span>,</span>
<span>                            min_similarity <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p>Methods:</p>
<ul>
<li>
<strong><code>"llm"</code></strong> (default) – Uses Claude to
semantically compare records</li>
<li>
<strong><code>"embedding"</code></strong> – Cosine similarity on
text embeddings</li>
<li>
<strong><code>"jaccard"</code></strong> – Fast n-gram based
comparison (no API calls)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="customizing-for-your-domain">Customizing for Your Domain<a class="anchor" aria-label="anchor" href="#customizing-for-your-domain"></a>
</h2>
<p>EcoExtract is domain-agnostic. Customize it by editing the schema and
extraction prompt.</p>
<div class="section level3">
<h3 id="initialize-custom-configuration">Initialize Custom Configuration<a class="anchor" aria-label="anchor" href="#initialize-custom-configuration"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creates ecoextract/ directory with template files</span></span>
<span><span class="fu"><a href="../reference/init_ecoextract.html">init_ecoextract</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This creates:</span></span>
<span><span class="co"># - ecoextract/SCHEMA_GUIDE.md      # Read this first!</span></span>
<span><span class="co"># - ecoextract/schema.json          # Edit for your domain</span></span>
<span><span class="co"># - ecoextract/extraction_prompt.md # Edit for your domain</span></span></code></pre></div>
<p>Edit the files in <code>ecoextract/</code> for your research domain,
then process as usual – the package automatically detects configuration
files in this directory:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Automatically uses ecoextract/schema.json and ecoextract/extraction_prompt.md</span></span>
<span><span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span><span class="st">"pdfs/"</span>, <span class="st">"ecoextract_records.db"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or specify custom files explicitly</span></span>
<span><span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"pdfs/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"ecoextract_records.db"</span>,</span>
<span>  schema_file <span class="op">=</span> <span class="st">"my_custom/schema.json"</span>,</span>
<span>  extraction_prompt_file <span class="op">=</span> <span class="st">"my_custom/extraction.md"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For detailed guidance on writing schemas and prompts, see the <a href="configuration.html">Configuration Guide</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="retrieving-your-data">Retrieving Your Data<a class="anchor" aria-label="anchor" href="#retrieving-your-data"></a>
</h2>
<div class="section level3">
<h3 id="query-records">Query Records<a class="anchor" aria-label="anchor" href="#query-records"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all records from all documents</span></span>
<span><span class="va">all_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_records.html">get_records</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get records from a specific document</span></span>
<span><span class="va">doc_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_records.html">get_records</a></span><span class="op">(</span>document_id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use a custom database path</span></span>
<span><span class="va">records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_records.html">get_records</a></span><span class="op">(</span>db_conn <span class="op">=</span> <span class="st">"my_project.db"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="query-documents">Query Documents<a class="anchor" aria-label="anchor" href="#query-documents"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all documents and their metadata</span></span>
<span><span class="va">all_docs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_documents.html">get_documents</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check processing status</span></span>
<span><span class="va">all_docs</span><span class="op">$</span><span class="va">ocr_status</span>          <span class="co"># "completed", "pending", "failed"</span></span>
<span><span class="va">all_docs</span><span class="op">$</span><span class="va">metadata_status</span></span>
<span><span class="va">all_docs</span><span class="op">$</span><span class="va">extraction_status</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="export-data">Export Data<a class="anchor" aria-label="anchor" href="#export-data"></a>
</h3>
<p>The <code><a href="../reference/export_db.html">export_db()</a></code> function joins records with document
metadata:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all records with metadata as a tibble</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/export_db.html">export_db</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export to CSV file</span></span>
<span><span class="fu"><a href="../reference/export_db.html">export_db</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"extracted_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export only records from specific document</span></span>
<span><span class="fu"><a href="../reference/export_db.html">export_db</a></span><span class="op">(</span>document_id <span class="op">=</span> <span class="fl">1</span>, filename <span class="op">=</span> <span class="st">"document_1.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Include OCR content in export (large files!)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/export_db.html">export_db</a></span><span class="op">(</span>include_ocr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simplified export (removes processing metadata columns)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/export_db.html">export_db</a></span><span class="op">(</span>simple <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The exported data includes document metadata (title, authors,
journal, DOI), all extracted record fields (defined by your schema), and
processing status with timestamps.</p>
</div>
<div class="section level3">
<h3 id="view-ocr-results">View OCR Results<a class="anchor" aria-label="anchor" href="#view-ocr-results"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get OCR markdown text</span></span>
<span><span class="va">markdown</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ocr_markdown.html">get_ocr_markdown</a></span><span class="op">(</span>document_id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">markdown</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View OCR with embedded images in RStudio Viewer</span></span>
<span><span class="fu"><a href="../reference/get_ocr_html_preview.html">get_ocr_html_preview</a></span><span class="op">(</span>document_id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View all pages</span></span>
<span><span class="fu"><a href="../reference/get_ocr_html_preview.html">get_ocr_html_preview</a></span><span class="op">(</span>document_id <span class="op">=</span> <span class="fl">1</span>, page_num <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="human-review-workflow">Human Review Workflow<a class="anchor" aria-label="anchor" href="#human-review-workflow"></a>
</h2>
<p>After extraction, review and correct results using the
<strong>ecoreview</strong> Shiny app.</p>
<div class="section level3">
<h3 id="launch-the-review-app">Launch the Review App<a class="anchor" aria-label="anchor" href="#launch-the-review-app"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ecoreview</span><span class="op">)</span></span>
<span><span class="fu">run_review_app</span><span class="op">(</span>db_path <span class="op">=</span> <span class="st">"ecoextract_records.db"</span><span class="op">)</span></span></code></pre></div>
<p>The app provides:</p>
<ul>
<li>
<strong>Document-by-document review</strong> – Navigate through all
processed documents</li>
<li>
<strong>Side-by-side view</strong> – See OCR text and extracted
records together</li>
<li>
<strong>Edit records</strong> – Modify extracted data directly</li>
<li>
<strong>Add records</strong> – Manually add records the LLM
missed</li>
<li>
<strong>Delete records</strong> – Remove incorrect records</li>
<li>
<strong>Automatic audit trail</strong> – All edits tracked in
<code>record_edits</code> table</li>
</ul>
</div>
<div class="section level3">
<h3 id="review-workflow">Review Workflow<a class="anchor" aria-label="anchor" href="#review-workflow"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Process documents</strong> with EcoExtract</li>
<li>
<strong>Launch review app</strong> with your database</li>
<li>
<strong>Review each document</strong> – check records against source
text, edit, add, delete as needed, click “Accept”</li>
<li>
<strong>Export final data</strong> with corrections</li>
</ol>
</div>
<div class="section level3">
<h3 id="edit-tracking">Edit Tracking<a class="anchor" aria-label="anchor" href="#edit-tracking"></a>
</h3>
<p>The <code><a href="../reference/save_document.html">save_document()</a></code> function (used by ecoreview) tracks
all changes:</p>
<ul>
<li>
<strong>Column-level edits</strong> – Knows exactly which fields
were changed</li>
<li>
<strong>Original values</strong> – Stores the LLM’s original
extraction</li>
<li>
<strong>Edit timestamps</strong> – When each change was made</li>
<li>
<strong>Added/deleted flags</strong> – Distinguishes human-added vs
LLM-extracted records</li>
</ul>
<p>This audit trail enables accuracy calculations, understanding LLM
performance, and quality control.</p>
<p>For more information, see the <a href="https://github.com/n8layman/ecoreview" class="external-link">ecoreview
repository</a>.</p>
</div>
<div class="section level3">
<h3 id="calculate-accuracy-metrics">Calculate Accuracy Metrics<a class="anchor" aria-label="anchor" href="#calculate-accuracy-metrics"></a>
</h3>
<p>After reviewing documents, calculate comprehensive accuracy
metrics:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_accuracy.html">calculate_accuracy</a></span><span class="op">(</span><span class="st">"ecoextract_records.db"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View key metrics</span></span>
<span><span class="va">accuracy</span><span class="op">$</span><span class="va">detection_recall</span>      <span class="co"># Did we find the records?</span></span>
<span><span class="va">accuracy</span><span class="op">$</span><span class="va">field_precision</span>       <span class="co"># How accurate were the fields?</span></span>
<span><span class="va">accuracy</span><span class="op">$</span><span class="va">field_f1</span>              <span class="co"># Overall field-level F1 score</span></span>
<span><span class="va">accuracy</span><span class="op">$</span><span class="va">major_edit_rate</span>       <span class="co"># How serious were the errors?</span></span>
<span><span class="va">accuracy</span><span class="op">$</span><span class="va">avg_edits_per_document</span> <span class="co"># Average corrections needed</span></span></code></pre></div>
<p>EcoExtract provides nuanced accuracy metrics that separate:</p>
<ul>
<li>
<strong>Record detection</strong> – Finding records vs
missing/hallucinating them</li>
<li>
<strong>Field-level accuracy</strong> – Correctness of individual
fields (gives partial credit)</li>
<li>
<strong>Edit severity</strong> – Major edits (unique/required
fields) vs minor edits</li>
</ul>
<p>For a complete explanation, see <a href="../ACCURACY.html">ACCURACY.md</a>. Accuracy visualizations are
available in the <a href="https://github.com/n8layman/ecoreview" class="external-link">ecoreview</a> Shiny
app.</p>
</div>
</div>
<div class="section level2">
<h2 id="complete-example">Complete Example<a class="anchor" aria-label="anchor" href="#complete-example"></a>
</h2>
<p>End-to-end workflow from processing through review and export:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/n8layman/ecoextract" class="external-link">ecoextract</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Initialize custom configuration (first time only)</span></span>
<span><span class="fu"><a href="../reference/init_ecoextract.html">init_ecoextract</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Edit ecoextract/schema.json and ecoextract/extraction_prompt.md</span></span>
<span></span>
<span><span class="co"># 2. Process documents with parallel processing</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"papers/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"records.db"</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Launch review app</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ecoreview</span><span class="op">)</span></span>
<span><span class="fu">run_review_app</span><span class="op">(</span>db_path <span class="op">=</span> <span class="st">"records.db"</span><span class="op">)</span></span>
<span><span class="co"># Review and edit records in the Shiny app</span></span>
<span></span>
<span><span class="co"># 4. Export final data</span></span>
<span><span class="va">final_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/export_db.html">export_db</a></span><span class="op">(</span></span>
<span>  db_conn <span class="op">=</span> <span class="st">"records.db"</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">"final_data.csv"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Check results</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">edited_records</span> <span class="op">&lt;-</span> <span class="va">final_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">human_edited</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total records:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">final_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Edited records:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">edited_records</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 6. Calculate accuracy</span></span>
<span><span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_accuracy.html">calculate_accuracy</a></span><span class="op">(</span><span class="st">"records.db"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="database-schema">Database Schema<a class="anchor" aria-label="anchor" href="#database-schema"></a>
</h2>
<p>The SQLite database has two main tables:</p>
<p><strong>documents</strong> – Stores document metadata and processing
status:</p>
<ul>
<li>
<code>document_id</code>, <code>file_name</code>,
<code>file_path</code> – Identity</li>
<li>
<code>title</code>, <code>authors</code>,
<code>publication_year</code>, <code>journal</code>, <code>doi</code> –
Publication metadata</li>
<li>
<code>document_content</code> – OCR markdown text</li>
<li>
<code>ocr_status</code>, <code>metadata_status</code>,
<code>extraction_status</code>, <code>refinement_status</code> –
Processing status</li>
<li>
<code>records_extracted</code> – Count of records extracted</li>
</ul>
<p><strong>records</strong> – Stores extracted data records:</p>
<ul>
<li>
<code>id</code> – Primary key (auto-increment)</li>
<li>
<code>document_id</code> – Foreign key to documents</li>
<li>
<code>record_id</code> – Human-readable identifier (e.g.,
“Smith2023-001”)</li>
<li>Custom fields defined by your schema</li>
<li>
<code>extraction_timestamp</code>, <code>llm_model_version</code> –
Metadata</li>
</ul>
<p><strong>record_edits</strong> – Audit trail for human edits:</p>
<ul>
<li>Tracks column-level changes with original values and timestamps</li>
</ul>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<p><strong>Start small.</strong> Test on 2-3 papers first. Review
results before processing an entire corpus.</p>
<p><strong>Use parallel processing for large batches.</strong> For 10+
papers, <code>workers = 4</code> significantly speeds up processing.</p>
<p><strong>Enable refinement selectively.</strong> Run refinement only
on documents that need it:
<code>run_refinement = c(5L, 12L, 18L)</code>.</p>
<p><strong>Review early and often.</strong> Process a small batch,
review immediately with ecoreview, then iterate on your schema and
prompts before processing more.</p>
<p><strong>Version control your configs.</strong> Add
<code>ecoextract/schema.json</code> and
<code>ecoextract/extraction_prompt.md</code> to git. Keep
<code>.env</code> (API keys) in <code>.gitignore</code>.</p>
<p><strong>Monitor API usage.</strong> Track usage at <a href="https://console.anthropic.com/" class="external-link uri">https://console.anthropic.com/</a>. Typical per-paper usage:
OCR ~2-5K tokens, metadata ~1-2K, extraction ~5-10K, refinement
~3-5K.</p>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="api-key-not-found">API Key Not Found<a class="anchor" aria-label="anchor" href="#api-key-not-found"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reload from .env file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRenviron.html" class="external-link">readRenviron</a></span><span class="op">(</span><span class="st">".env"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or set directly</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>ANTHROPIC_API_KEY <span class="op">=</span> <span class="st">"sk-ant-..."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"ANTHROPIC_API_KEY"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="database-locked-errors">Database Locked Errors<a class="anchor" aria-label="anchor" href="#database-locked-errors"></a>
</h3>
<p>If you get “database is locked” during parallel processing, this
usually resolves automatically. Verify WAL mode is enabled:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"records.db"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">db</span>, <span class="st">"PRAGMA journal_mode"</span><span class="op">)</span>  <span class="co"># Should return "wal"</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">db</span>, <span class="st">"PRAGMA busy_timeout"</span><span class="op">)</span>  <span class="co"># Should return 30000</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="schema-validation-errors">Schema Validation Errors<a class="anchor" aria-label="anchor" href="#schema-validation-errors"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Validate JSON syntax</span></span>
<span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/validate.html" class="external-link">validate</a></span><span class="op">(</span><span class="st">"ecoextract/schema.json"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify structure (must have top-level "records" property)</span></span>
<span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/read_json.html" class="external-link">read_json</a></span><span class="op">(</span><span class="st">"ecoextract/schema.json"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">schema</span><span class="op">$</span><span class="va">properties</span><span class="op">)</span>  <span class="co"># Should include "records"</span></span>
<span></span>
<span><span class="co"># Test with default schema first</span></span>
<span><span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span><span class="st">"test.pdf"</span>, <span class="st">"test.db"</span>, schema_file <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ocr-failures">OCR Failures<a class="anchor" aria-label="anchor" href="#ocr-failures"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check which documents failed</span></span>
<span><span class="va">docs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_documents.html">get_documents</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">failed</span> <span class="op">&lt;-</span> <span class="va">docs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ocr_status</span> <span class="op">==</span> <span class="st">"failed"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Force reprocess failed OCR</span></span>
<span><span class="fu"><a href="../reference/process_documents.html">process_documents</a></span><span class="op">(</span></span>
<span>  pdf_path <span class="op">=</span> <span class="st">"pdfs/"</span>,</span>
<span>  db_conn <span class="op">=</span> <span class="st">"records.db"</span>,</span>
<span>  force_reprocess_ocr <span class="op">=</span> <span class="va">failed</span><span class="op">$</span><span class="va">document_id</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<ul>
<li>
<strong><a href="configuration.html">Configuration
Guide</a></strong> – Customize schema and prompts for your domain</li>
<li>
<strong><a href="testing.html">Testing Guide</a></strong> – Running
and writing tests</li>
<li>
<strong><a href="../ACCURACY.html">ACCURACY.md</a></strong> –
Understanding accuracy metrics in depth</li>
<li>
<strong>Function docs</strong>: <code><a href="../reference/process_documents.html">?process_documents</a></code>,
<code><a href="../reference/get_records.html">?get_records</a></code>, <code><a href="../reference/export_db.html">?export_db</a></code>,
<code><a href="../reference/calculate_accuracy.html">?calculate_accuracy</a></code>
</li>
<li>
<strong>Repos</strong>: <a href="https://github.com/n8layman/ecoextract" class="external-link">ecoextract</a> | <a href="https://github.com/n8layman/ecoreview" class="external-link">ecoreview</a> | <a href="https://github.com/n8layman/ohseer" class="external-link">ohseer</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Your Name.</p>
</div>

<div class="pkgdown-footer-right">
  <p>list(text = “EcoExtract - Structured ecological data extraction from scientific literature”)</p>
</div>

    </footer>
</div>



  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>
  mermaid.initialize({ startOnLoad: false, theme: "default" });
  document.querySelectorAll("pre.mermaid").forEach(function(pre) {
    var code = pre.querySelector("code");
    var text = code ? code.textContent : pre.textContent;
    var div = document.createElement("div");
    div.className = "mermaid";
    div.textContent = text;
    pre.parentElement.replaceChild(div, pre);
  });
  mermaid.run();
</script>
</body>
</html>
