% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/workflow.R
\name{process_documents}
\alias{process_documents}
\title{Complete Document Processing Workflow}
\usage{
process_documents(
  pdf_path,
  db_conn = "ecoextract_records.db",
  schema_file = NULL,
  extraction_prompt_file = NULL,
  refinement_prompt_file = NULL,
  force_reprocess_ocr = FALSE,
  force_reprocess_metadata = FALSE,
  run_extraction = TRUE,
  run_refinement = FALSE
)
}
\arguments{
\item{pdf_path}{Path to a single PDF file or directory of PDFs}

\item{db_conn}{Database connection (any DBI backend) or path to SQLite database file.
If a path is provided, creates SQLite database if it doesn't exist.
If a connection is provided, tables must already exist (use \code{init_ecoextract_database()} first).}

\item{schema_file}{Optional custom schema file}

\item{extraction_prompt_file}{Optional custom extraction prompt}

\item{refinement_prompt_file}{Optional custom refinement prompt}

\item{force_reprocess_ocr}{If TRUE, re-run OCR and delete all data for documents (OCR, metadata, records, status, reasoning). User will be warned. Default FALSE - skips if OCR already done.}

\item{force_reprocess_metadata}{If TRUE, re-run metadata extraction and overwrite all metadata fields. Default FALSE - skips if metadata already exists.}

\item{run_extraction}{If TRUE, run extraction step to find new records. Default TRUE.}

\item{run_refinement}{If TRUE, run refinement step to enhance existing records. Default FALSE.}
}
\value{
Tibble with processing results
}
\description{
Process PDFs through the complete pipeline: OCR → Metadata → Extract → Refine
}
\examples{
\dontrun{
# Basic usage - process new PDFs
process_documents("pdfs/")
process_documents("paper.pdf", "my_interactions.db")

# Remote database (Supabase, PostgreSQL, etc.)
library(RPostgres)
con <- dbConnect(Postgres(),
  dbname = "your_db",
  host = "db.xxx.supabase.co",
  user = "postgres",
  password = Sys.getenv("SUPABASE_PASSWORD")
)
# Initialize schema first
init_ecoextract_database(con)
# Then process documents
process_documents("pdfs/", db_conn = con)
dbDisconnect(con)

# Force re-run OCR (WARNING: deletes ALL data for documents - OCR, metadata, records)
process_documents("pdfs/", force_reprocess_ocr = TRUE)

# Force re-run metadata only (overwrites metadata fields, keeps records)
process_documents("pdfs/", force_reprocess_metadata = TRUE)

# With custom schema and prompts
process_documents("pdfs/", "interactions.db",
                  schema_file = "ecoextract/schema.json",
                  extraction_prompt_file = "ecoextract/extraction_prompt.md")

# With refinement (opt-in)
process_documents("pdfs/", run_refinement = TRUE)

# Skip extraction, refinement only on existing records
process_documents("pdfs/", run_extraction = FALSE, run_refinement = TRUE)
}
}
