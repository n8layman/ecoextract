% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/workflow.R
\name{process_documents}
\alias{process_documents}
\title{Complete Document Processing Workflow}
\usage{
process_documents(
  pdf_path,
  db_conn = "ecoextract_records.db",
  schema_file = NULL,
  extraction_prompt_file = NULL,
  refinement_prompt_file = NULL,
  run_ocr = TRUE,
  run_metadata = TRUE,
  run_extraction = TRUE,
  run_refinement = FALSE
)
}
\arguments{
\item{pdf_path}{Path to a single PDF file or directory of PDFs}

\item{db_conn}{Database connection (any DBI backend) or path to SQLite database file.
If a path is provided, creates SQLite database if it doesn't exist.
If a connection is provided, tables must already exist (use \code{init_ecoextract_database()} first).}

\item{schema_file}{Optional custom schema file}

\item{extraction_prompt_file}{Optional custom extraction prompt}

\item{refinement_prompt_file}{Optional custom refinement prompt}

\item{run_ocr}{If TRUE, run OCR step. Re-running deletes metadata and records (default: TRUE)}

\item{run_metadata}{If TRUE, run metadata extraction. Re-running overwrites all fields (default: TRUE)}

\item{run_extraction}{If TRUE, run extraction step (default: TRUE)}

\item{run_refinement}{If TRUE, run refinement step (default: FALSE)}
}
\value{
Tibble with processing results
}
\description{
Process PDFs through the complete pipeline: OCR → Audit → Extract → Refine
}
\examples{
\dontrun{
# SQLite (path string - automatic initialization)
process_documents("pdfs/")
process_documents("paper.pdf", "my_interactions.db")

# Remote database (Supabase, PostgreSQL, etc.)
library(RPostgres)
con <- dbConnect(Postgres(),
  dbname = "your_db",
  host = "db.xxx.supabase.co",
  user = "postgres",
  password = Sys.getenv("SUPABASE_PASSWORD")
)
# Initialize schema first
init_ecoextract_database(con)
# Then process documents
process_documents("pdfs/", db_conn = con)
dbDisconnect(con)

# Re-run OCR (deletes metadata + records, starts fresh)
process_documents("pdfs/", run_ocr = TRUE)

# Re-run metadata only (overwrites all metadata fields)
process_documents("pdfs/", run_ocr = FALSE, run_metadata = TRUE)

# With custom schema and prompts
process_documents("pdfs/", "interactions.db",
                  schema_file = "ecoextract/schema.json",
                  extraction_prompt_file = "ecoextract/extraction_prompt.md")

# With refinement (opt-in)
process_documents("pdfs/", run_refinement = TRUE)

# Skip extraction (refinement only on existing records)
process_documents("pdfs/", run_extraction = FALSE, run_refinement = TRUE)
}
}
